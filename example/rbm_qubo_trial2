julia> rbm_qubo = QARBoM.QUBORBM(22,10, W,  DWave.Neal.Optimizer)
QUBORBM(A JuMP Model
Minimization problem with:
Variables: 32
Objective function type: JuMP.QuadExpr
`JuMP.VariableRef`-in-`MathOptInterface.ZeroOne`: 32 constraints
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: D-Wave Neal Simulated Annealing Sampler
Names registered in the model: hid, vis, 22, 10)

julia> avg_loss = QARBoM.train_persistent_qubo(rbm_qubo, x_train[1:10000];n_samples = 1, batch_size = 10, n_epochs = 50, learning_rate = 0.01)
Setting mini-batches
Starting training
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     1 |   11.3454 |        2.8878 |     344.8806 |        1.9557 |  349.7240 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     2 |   10.0043 |        2.6441 |     337.6602 |        1.4058 |  691.4342 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     3 |    9.8736 |        2.6020 |     362.9394 |        1.5230 | 1058.4986 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     4 |    9.7203 |        2.5639 |     373.1985 |        1.4216 | 1435.6827 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     5 |    9.3213 |        3.0644 |     382.8465 |        1.3112 | 1822.9048 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     6 |    9.0067 |        2.5147 |     387.5862 |        1.6915 | 2214.6972 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     7 |    8.6209 |        2.5493 |     379.2896 |        1.5268 | 2598.0629 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     8 |    8.2425 |        2.4400 |     381.2236 |        1.6691 | 2983.3956 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     9 |    7.7802 |        3.4057 |     406.4224 |        1.3201 | 3394.5438 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    10 |    7.3861 |        3.3419 |     448.4303 |        1.6491 | 3847.9650 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    11 |    6.8929 |        2.5863 |     419.6701 |        1.3028 | 4271.5242 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    12 |    6.3611 |        2.5968 |     423.2960 |        1.3091 | 4698.7262 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    13 |    6.0234 |        3.1023 |     435.0310 |        1.7352 | 5138.5946 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    14 |    5.7455 |        3.2100 |     407.2500 |        1.2937 | 5550.3483 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    15 |    5.5930 |        2.8605 |     363.4494 |        1.4475 | 5918.1058 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    16 |    5.5642 |        2.4793 |     341.4992 |        1.4228 | 6263.5071 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    17 |    5.5640 |        2.3117 |     359.0388 |        1.4862 | 6626.3438 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    18 |    5.5645 |        3.5116 |     382.0711 |        1.6362 | 7013.5627 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    19 |    5.5636 |        3.8185 |     370.3583 |        1.4553 | 7389.1948 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    20 |    5.5634 |        2.7383 |     363.4242 |        1.6589 | 7757.0162 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    21 |    5.5654 |        2.7117 |     341.4214 |        1.2892 | 8102.4385 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    22 |    5.5657 |        2.7761 |     343.4671 |        1.2951 | 8449.9768 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    23 |    5.5653 |        3.0894 |     361.6862 |        1.3953 | 8816.1478 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    24 |    5.5646 |        3.0806 |     354.7854 |        1.4899 | 9175.5037 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    25 |    5.5645 |        2.8374 |     343.6265 |        1.4321 | 9523.3997 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    26 |    5.5652 |        3.1916 |     351.3480 |        1.7083 | 9879.6477 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    27 |    5.5645 |        2.7007 |     369.8594 |        1.4267 | 10253.6344 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    28 |    5.5644 |        3.3253 |     368.2971 |        1.6830 | 10626.9399 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    29 |    5.5658 |        3.2931 |     344.5176 |        1.3132 | 10976.0638 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    30 |    5.5645 |        3.1464 |     350.9636 |        1.4822 | 11331.6561 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    31 |    5.5652 |        3.2205 |     353.2124 |        1.4969 | 11689.5858 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    32 |    5.5643 |        2.6277 |     362.0595 |        1.5874 | 12055.8605 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    33 |    5.5655 |        2.5988 |     343.7080 |        1.4329 | 12403.6002 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    34 |    5.5642 |        2.7579 |     345.1047 |        1.3186 | 12752.7814 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    35 |    5.5635 |        2.9266 |     363.8605 |        1.5134 | 13121.0819 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    36 |    5.5643 |        2.8313 |     341.4716 |        1.4126 | 13466.7975 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    37 |    5.5646 |        3.0932 |     341.8717 |        1.4102 | 13813.1726 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    38 |    5.5645 |        3.3174 |     365.1378 |        1.4339 | 14183.0618 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    39 |    5.5648 |        2.7259 |     361.1946 |        1.5220 | 14548.5043 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    40 |    5.5649 |        2.8387 |     354.9658 |        1.3441 | 14907.6530 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    41 |    5.5647 |        3.0988 |     343.7654 |        1.3058 | 15255.8230 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    42 |    5.5652 |        2.6782 |     346.4900 |        1.7232 | 15606.7144 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    43 |    5.5644 |        3.2987 |     349.8493 |        1.3315 | 15961.1939 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    44 |    5.5640 |        2.9803 |     343.4565 |        1.2943 | 16308.9250 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    45 |    5.5644 |        2.1039 |     350.4718 |        1.6525 | 16663.1532 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    46 |    5.5631 |        3.0282 |     350.4265 |        1.3428 | 17017.9507 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    47 |    5.5635 |        3.1575 |     349.7701 |        1.7230 | 17372.6013 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    48 |    5.5647 |        2.7682 |     349.6512 |        1.4790 | 17726.4996 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    49 |    5.5644 |        2.7805 |     350.4107 |        1.4717 | 18081.1625 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    50 |    5.5644 |        2.1046 |     345.7261 |        1.4569 | 18430.4501 |
|------------------------------------------------------------------------------|
Finished training after 50 epochs.
Total time spent sampling: 144.31822276115417
Total time spent in Quantum sampling: 18212.142402410507
Total time spent updating parameters: 73.98944449424744
Total time spent training: 18430.45006966591
50-element Vector{Float64}:
 11.34543538342091
 10.004295229606754
  9.873603263674983
  9.720307454790719
  9.32128592465913
  9.006710220040583
  8.620921945426206
  8.242494300562246
  7.780154539002184
  7.386143430190465
  6.892887129061186
  6.361124125503507
  6.023401554144211
  5.745496402358359
  5.593002514633263
  5.5642346178695865
  5.5639570489430845
  5.564495123767386
  5.563645664028981
  5.56341356304586
  5.565365117417646
  5.565669717339911
  5.565340448840359
  5.5646398719074295
  5.564527762765202
  5.565224783351306
  5.564498445274738
  5.564386194450407
  5.5658490321823795
  5.564502463122024
  5.565181386820911
  5.56432232032411
  5.565466017776607
  5.564179802296263
  5.56351336988561
  5.564320341445226
  5.564550628810655
  5.564547697310181
  5.564801303674668
  5.564856261751567
  5.564699762255694
  5.565238862370172
  5.564369704048595
  5.564033472172167
  5.564379507085499
  5.5631488559571185
  5.563519307530331
  5.564704423164165
  5.564410044408831
  5.564409462723221

julia> 
