
julia> rbm_qubo = QARBoM.QUBORBM(22,10, W,  DWave.Neal.Optimizer)
QUBORBM(A JuMP Model
Minimization problem with:
Variables: 32
Objective function type: JuMP.QuadExpr
`JuMP.VariableRef`-in-`MathOptInterface.ZeroOne`: 32 constraints
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: D-Wave Neal Simulated Annealing Sampler
Names registered in the model: hid, vis, 22, 10)

julia> MOI.set(rbm_qubo.model, MOI.RawOptimizerAttribute("num_reads"), 250)

julia> MOI.set(rbm_qubo.model, MOI.RawOptimizerAttribute("num_sweeps"), 50)

julia> avg_loss = QARBoM.train_persistent_qubo(rbm_qubo, x_train[1:10000];n_samples = 1, batch_size = 10, n_epochs = 50, learning_rate = [0.001 for i in 1:50])
Setting mini-batches
Starting training
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     1 |    8.3389 |        0.0593 |      19.3312 |        0.8522 |   20.2427 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     2 |    3.6758 |        0.0965 |      22.8704 |        0.8023 |   44.0119 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     3 |    3.5124 |        0.0152 |      21.0423 |        0.6857 |   65.7552 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     4 |    3.4260 |        0.0161 |      21.3847 |        0.9883 |   88.1443 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     5 |    3.3978 |        0.0160 |      21.9867 |        0.8899 |  111.0369 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     6 |    3.3801 |        0.0194 |      26.4830 |        1.1558 |  138.6951 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     7 |    3.3352 |        0.0792 |      26.6887 |        1.0211 |  166.4841 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     8 |    3.2881 |        0.0177 |      26.0644 |        1.0558 |  193.6220 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|     9 |    3.2339 |        0.0179 |      24.8507 |        0.8738 |  219.3644 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    10 |    3.1793 |        0.0167 |      23.3188 |        0.8757 |  243.5755 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    11 |    3.1436 |        0.0174 |      22.8857 |        0.8314 |  267.3101 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    12 |    3.1005 |        0.0174 |      23.8152 |        0.9627 |  292.1054 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    13 |    3.0559 |        0.2348 |      21.8716 |        0.9382 |  315.1500 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    14 |    3.0133 |        0.1358 |      21.3366 |        0.8181 |  337.4404 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    15 |    2.9670 |        0.0175 |      23.2721 |        0.8500 |  361.5799 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    16 |    2.9190 |        0.0170 |      23.1263 |        0.8352 |  385.5584 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    17 |    2.8765 |        0.0180 |      23.3429 |        1.2962 |  410.2156 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    18 |    2.8494 |        0.1285 |      21.1617 |        0.8429 |  432.3487 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    19 |    2.8425 |        0.0733 |      23.9901 |        0.9462 |  457.3582 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    20 |    2.8292 |        0.0284 |      25.7584 |        1.0548 |  484.1999 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    21 |    2.8061 |        0.0177 |      22.2651 |        0.9625 |  507.4451 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    22 |    2.7853 |        0.0156 |      20.6618 |        0.7100 |  528.8325 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    23 |    2.7692 |        0.0677 |      21.9945 |        0.7925 |  551.6873 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    24 |    2.7457 |        0.0171 |      23.5216 |        1.0172 |  576.2432 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    25 |    2.7313 |        0.0174 |      22.8648 |        0.9775 |  600.1028 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    26 |    2.7065 |        0.1522 |      22.9504 |        0.9162 |  624.1217 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    27 |    2.6541 |        0.1101 |      20.7344 |        0.7844 |  645.7507 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    28 |    2.5970 |        0.0158 |      20.4396 |        0.7324 |  666.9384 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    29 |    2.5386 |        0.0150 |      19.3576 |        1.0739 |  687.3849 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    30 |    2.4978 |        0.0815 |      20.1479 |        0.8447 |  708.4589 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    31 |    2.4535 |        0.0155 |      20.0836 |        0.8362 |  729.3942 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    32 |    2.4392 |        0.0147 |      18.4119 |        0.8176 |  748.6383 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    33 |    2.4245 |        0.0773 |      18.4751 |        0.9050 |  768.0957 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    34 |    2.4003 |        0.0162 |      21.4829 |        1.0505 |  790.6453 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    35 |    2.3709 |        0.0165 |      24.2716 |        0.9384 |  815.8718 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    36 |    2.3377 |        0.0922 |      22.2773 |        0.9158 |  839.1571 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    37 |    2.2948 |        0.0170 |      22.9579 |        0.7655 |  862.8974 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    38 |    2.2750 |        0.0175 |      22.7569 |        1.2395 |  886.9113 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    39 |    2.2734 |        0.0831 |      20.4192 |        0.9132 |  908.3267 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    40 |    2.2803 |        0.0164 |      21.6601 |        0.8354 |  930.8386 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    41 |    2.2701 |        0.0830 |      20.2931 |        0.7550 |  951.9697 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    42 |    2.2676 |        0.0226 |      25.3477 |        1.0127 |  978.3527 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    43 |    2.2912 |        0.0166 |      22.0918 |        1.2224 | 1001.6835 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    44 |    2.3177 |        0.0770 |      24.5036 |        0.8882 | 1027.1524 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    45 |    2.3106 |        0.0766 |      21.3958 |        0.8580 | 1049.4827 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    46 |    2.2767 |        0.0169 |      24.7755 |        0.7608 | 1075.0359 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    47 |    2.2580 |        0.0189 |      24.3313 |        1.1182 | 1100.5043 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    48 |    2.2591 |        0.0169 |      18.9221 |        0.8056 | 1120.2490 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    49 |    2.2516 |        0.0675 |      21.1607 |        0.7197 | 1142.1968 |
|------------------------------------------------------------------------------|
|------------------------------------------------------------------------------|
| Epoch |    MSE    | Time (Sample) | Time (Qsamp) | Time (Update) | Total     |
|------------------------------------------------------------------------------|
|    50 |    2.2552 |        0.1283 |      20.1151 |        0.8832 | 1163.3235 |
|------------------------------------------------------------------------------|
Finished training after 50 epochs.
Total time spent sampling: 2.442624807357788
Total time spent in Quantum sampling: 1115.2522683143616
Total time spent updating parameters: 45.628602027893066
Total time spent training: 1163.3234951496124
50-element Vector{Float64}:
 8.33892620245422
 3.67579888306555
 3.51242387200855
 3.426019686407857
 3.397815815985814
 ⋮
 2.276676315960908
 2.258040847342386
 2.2590765799629846
 2.2515909223695094
 2.2551572558150004

julia> println(avg_loss)
[8.33892620245422, 3.67579888306555, 3.51242387200855, 3.426019686407857, 3.397815815985814, 3.380122202830872, 3.335199496998629, 3.2881458710679987, 3.233873315796475, 3.1792844891457612, 3.1435793158820644, 3.1004679009393916, 3.0558915357724095, 3.0132541268333384, 2.967024844738782, 2.919022270857961, 2.87653402093061, 2.8493573464243567, 2.8425152952098425, 2.8291957938050656, 2.8060986256425493, 2.785330791118943, 2.7692188127617015, 2.7456788561030048, 2.7313446999259954, 2.7065121019561067, 2.654056642195051, 2.596974063743883, 2.5385631813166243, 2.4978324393144944, 2.4534641823381422, 2.439154998473601, 2.4244555306011546, 2.40034114590193, 2.370892981911358, 2.337749377438203, 2.2947956937259546, 2.274957094173082, 2.2734406898729898, 2.2803198420558894, 2.2701482765780105, 2.2676417222322356, 2.2912230712953767, 2.317749616267681, 2.3105707269727116, 2.276676315960908, 2.258040847342386, 2.2590765799629846, 2.2515909223695094, 2.2551572558150004]

julia> 


julia> println(W)
[0.9266602441202795 0.6243998131483609 0.72737616857548 0.8632509543744681 0.8614409720701803 0.41926320952275886 0.10194080895808688 0.7259018106990387 0.4756132279608558 0.5963357720866489; 0.5850684532440414 0.8067042533629035 0.48444025923766276 0.312747625806834 0.4446385779960227 0.37345804491630075 0.10876200321458607 0.9292063755181023 0.869254429376144 0.22994894258604381; 0.877454259619822 0.5381916113040222 0.9698172286166601 0.4293184784736037 0.8215761130561067 0.725111323645607 0.5304207956213082 0.6599503369838402 0.7472447063226542 0.7086393344492835; 0.40892585355773525 0.045078326579748196 0.280547638075167 0.6689910170932147 0.46078733765286317 0.9447201185072388 0.5874029302793303 0.5955949693069088 0.4494105694189544 0.8327459259696418; 0.41006319847351635 0.9549985469860568 0.9305925386637345 0.13103063082171784 0.6746472823582826 0.0635226083251248 0.9782675292193264 0.49959625860329593 0.6768398522013442 0.022220963484653855; 0.4357321634071274 0.3514458763938789 0.7101268729269351 0.12158485327937085 0.17575628568170254 0.38346923367433217 0.3459459408321689 0.038994730238374964 0.13727967165675792 0.08208811830709117; 0.36208253270697954 0.39294717872913676 0.9492685430229181 0.806361420442281 0.9870553146635529 0.7898839120897301 0.826304430409747 0.635188224359511 0.09053566400500668 0.2791090908604751; 0.8460887843785027 0.6123092998592107 0.22071569978829997 0.5408885395694808 0.44043141143386033 0.8308824221388982 0.44494906287124336 0.9793179570019739 0.6426849050116722 0.6653259304896002; 0.9617602909810016 0.22178077225059878 0.7242706905021732 0.8001763713812363 0.4251464106002758 0.5349359289058165 0.23740705799514594 0.665656681005212 0.2889368431723883 0.558830162246548; 0.07103326946348254 0.2008180297654778 0.17020024858888871 0.07833117313882632 0.08008270679451557 0.37772201322335297 0.2642941615349228 0.775161332890083 0.8660364471082151 0.665479286724534; 0.14474939665529118 0.6787525860795238 0.76337124123519 0.09478502594543103 0.11942166335924509 0.25449417817836273 0.7403139204462524 0.04313434397173199 0.37223803747696516 0.7530364154501423; 0.16549445059621726 0.9585089747418253 0.36176618690268436 0.42454167999433723 0.3395663244204602 0.34314905251640504 0.30215584947446916 0.19584385172530372 0.05317436729773539 0.502911231234765; 0.12561573888211008 0.8807985921548459 0.6902584559287895 0.4833451268550031 0.3805939944405531 0.6966141769369569 0.0630013428844125 0.7774479645208657 0.3939527962192222 0.5064819234883077; 0.15579633817659655 0.874756266697511 0.26409276259180503 0.08775623311159808 0.7326785842519421 0.3939561345951029 0.1292073357802921 0.8652568378297358 0.3865831707842575 0.9442283100794161; 0.23383332498571396 0.7905882966145015 0.03563823171342595 0.798518895423029 0.24619582714892108 0.5761219961672216 0.002292553902860983 0.520768221908944 0.8167734981888781 0.9709382621285653; 0.04036359563311498 0.0686847227915256 0.9991847401336695 0.18265463931310277 0.3559475248376126 0.7305656127849302 0.17988475210418242 0.5391829275806713 0.906423501816878 0.5453726404719987; 0.08383525847371831 0.07532335599501006 0.5540619397913991 0.7629680895416001 0.5304898701262377 0.6979323101231382 0.007037128208273069 0.4465741715202556 0.3957730453525876 0.28213652155461955; 0.07803912316938144 0.13312440606681375 0.9149110975535989 0.5273694851284257 0.312757336042341 0.9646102178141079 0.19993620417969304 0.8527452961532263 0.0587424014540171 0.7021691259508813; 0.29045774455656614 0.3485616818772235 0.4792002473363296 0.8464432890701407 0.8553968568316792 0.6891831575337608 0.933976036751207 0.5288647735576558 0.937319856233841 0.03665028869237985; 0.07183408950276349 0.12856701307776308 0.37626175978299425 0.6700183058146466 0.565212570901016 0.574155146984201 0.7687966259532194 0.6830700998763054 0.31398736963718477 0.42412977685493314; 0.25281635853582385 0.5164661530261214 0.7422539801857252 0.6204802590934246 0.18958582317964845 0.8873213947488903 0.36765159036749673 0.13685951443350008 0.3382053860085259 0.6332749774961136; 0.20020486138182003 0.7042251175706828 0.30053806253171145 0.7245946179660709 0.9624188011574812 0.9143025191901962 0.5726725795035547 0.6088731180039337 0.8737667774982304 0.7245037678997781]